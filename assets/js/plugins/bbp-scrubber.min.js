/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
!function(c){"use strict";window.BuddyBossThemeBbpScrubber={scrubbers:[],init:function(){var b=window.BuddyBossThemeBbpScrubber;c(".scrubber").each(function(r,e){var t=c(e).data("key"),s=c(e).closest("#bbpress-forums"),n=c(e).find("#reply-timeline-container").outerHeight();b.scrubbers[t]={total:s.find(".scrubberpost").length,onscroll_update:!0,scrubber_height_usable:n-c(e).find("#handle").outerHeight(),scrubber_height:n,currentnum:1,scrolltimer:null,handleani:null,draggie:null},b.scrubbers[t].total<3&&c(e).addClass("light"),b.init_draggabilly(t)}),window.addEventListener("scroll",b.onScrubberScroll),c(".scrubber").on("click",".firstpostbtn",function(r){r.preventDefault();var e=c(r.target).closest(".scrubber").data("key");b.goToPost(1,"first",e)}),c(".scrubber").on("click",".lastpostbtn",function(r){r.preventDefault();var e=c(r.target).closest(".scrubber").data("key");b.goToPost(b.scrubbers[e].total,"last",e)})},init_draggabilly:function(e){var t=window.BuddyBossThemeBbpScrubber,s=c('.scrubber[data-key="'+e+'"]');if(!s.length)return!1;t.scrubbers[e].draggie=s.find("#handle").draggabilly({axis:"y",grid:[1,1],containment:s.find("#reply-timeline-container")}),t.scrubbers[e].draggie.on("dragEnd",function(){s.find("#handle").removeClass("animate");var r="";1===t.scrubbers[e].currentnum?r="first":t.scrubbers[e].currentnum===t.scrubbers[e].total&&(r="last"),t.goToPost(t.scrubbers[e].currentnum,r,e)}),t.scrubbers[e].draggie.on("dragMove",function(){t.update_move(e)}),t.scrubbers[e].draggie.on("scroll",function(){t.update_move(e)}),t.updateDataOnFront(e)},updateDataOnFront:function(r){var e=window.BuddyBossThemeBbpScrubber,t=c('.scrubber[data-key="'+r+'"]');if(!t.length)return!1;e.scrubbers[r].total=t.closest("#bbpress-forums").find(".scrubberpost").length,t.find("#currentpost").text(e.scrubbers[r].currentnum),t.find("#totalposts").text(e.scrubbers[r].total);var s=t.closest("#bbpress-forums").find(".scrubberpost").eq(e.scrubbers[r].currentnum-1);t.find("#date").text(s.data("date"))},goToPost:function(r,e,t){var s=window.BuddyBossThemeBbpScrubber,n=c('.scrubber[data-key="'+t+'"]');if(!n.length)return!1;var b=n.closest("#bbpress-forums").find(".scrubberpost");if(!b.length)return!1;s.scrubbers[t].total=b.length,(s.scrubbers[t].currentnum=r)>b.length||1!==s.scrubbers[t].total&&r===s.scrubbers[t].total?(r=s.scrubbers[t].total-1,e="last"):1===r&&"last"!==e?(r=0,e="first"):1===r&&"last"===e?r=0:r-=1,0===r?s.scrubbers[t].currentnum=r+1:r===s.total&&(s.scrubbers[t].currentnum=s.scrubbers[t].total);var u=!1;"last"===e?r=s.scrubbers[t].total-1:"first"===e&&(u=!(r=0)),s.scrubbers[t].onscroll_update=!1;var a=0;void 0===b[r]?a=b[b.length]:(a=b[r],c(a).parent().addClass("highlight")),s.update_handle(u,t),c("html, body").animate({scrollTop:c(a).offset().top-window.innerHeight/2},600,function(){setTimeout(function(){c(a).parent().removeClass("highlight"),s.scrubbers[t].onscroll_update=!0},200)})},update_move:function(r){var e=window.BuddyBossThemeBbpScrubber,t=c('.scrubber[data-key="'+r+'"]');if(!t.length)return!1;e.scrubbers[r].total=t.closest("#bbpress-forums").find(".scrubberpost").length,e.scrubbers[r].scrubber_height_usable=e.scrubbers[r].scrubber_height-t.find("#handle").outerHeight();var s=e.scrubbers[r].scrubber_height_usable,n=t.find("#handle")[0].style.transform.split(",")[1];n=void 0!==n?n:0;for(var b=parseFloat(t.find("#handle")[0].style.top)+parseFloat(n),u=parseFloat(s/e.scrubbers[r].total),a=1;a<=e.scrubbers[r].total;a++)b<u*a&&u*(a-1)<b&&(e.scrubbers[r].currentnum=a,e.updateDataOnFront(r))},update_handle:function(r,e){var t=window.BuddyBossThemeBbpScrubber,s=c('.scrubber[data-key="'+e+'"]');if(!s.length)return!1;var n=s.find("#handle");if(!n.length)return!1;t.updateDataOnFront(e),t.scrubbers[e].scrubber_height_usable=t.scrubbers[e].scrubber_height-n.outerHeight();var b=t.scrubbers[e].scrubber_height_usable/t.scrubbers[e].total;1!==t.scrubbers[e].currentnum||1===t.scrubbers[e].total&&!r||(b=0),n.addClass("animate"),n.css("top",b*t.scrubbers[e].currentnum+"px"),clearTimeout(t.scrubbers[e].handleani),t.scrubbers[e].handleani=setTimeout(function(){n.length||n.removeClass("animate")},2e3)},onScrubberScroll:function(){var o=window.BuddyBossThemeBbpScrubber;c(".scrubber").each(function(r,e){var t=c(e).data("key");if(!o.scrubbers[t].onscroll_update)return!1;var s=c(e).closest("#bbpress-forums").find(".scrubberpost");if(!s.length)return!1;if(window.scrollY+window.innerHeight.height/2<s[0].getBoundingClientRect().y||0===window.scrollY)return o.scrubbers[t].currentnum=1,o.update_handle(!0,t),!1;if(window.scrollY+window.innerHeight>=document.body.scrollHeight){o.scrubbers[t].currentnum=o.scrubbers[t].total;var n=1!==o.scrubbers[t].total;return o.update_handle(n,t),!1}for(var b=o.scrubbers[t].currentnum,u=!1,a=0;a<s.length;a++)s[a].getBoundingClientRect().y<window.innerHeight/2&&(u=!0,b=a);b+1>o.scrubbers[t].total&&(b=o.scrubbers[t].total-1),u&&(o.scrubbers[t].currentnum=b+1,o.update_handle(!1,t))})}},c(document).on("ready",function(){window.BuddyBossThemeBbpScrubber.init()})}(jQuery);